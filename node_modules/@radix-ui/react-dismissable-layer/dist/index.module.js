import{useEscapeKeydown as e}from"@radix-ui/react-use-escape-keydown";import{useCallbackRef as t}from"@radix-ui/react-use-callback-ref";import{useBodyPointerEvents as n}from"@radix-ui/react-use-body-pointer-events";import{createContext as r}from"@radix-ui/react-context";import{Primitive as o}from"@radix-ui/react-primitive";import{composeEventHandlers as u}from"@radix-ui/primitive";import*as i from"react";import s from"@babel/runtime/helpers/esm/extends";const[a,c]=C(),[l,d]=b(),[m,f]=C("TotalLayerCountWithDisabledOutsidePointerEventsProvider"),[p,v]=b("RunningLayerCountWithDisabledOutsidePointerEventsProvider");export const DismissableLayer=/*#__PURE__*/i.forwardRef(((e,t)=>{const n=0===d(),r=/*#__PURE__*/i.createElement(E,s({},e,{ref:t}));return n?/*#__PURE__*/i.createElement(a,null,/*#__PURE__*/i.createElement(m,null,r)):r}));/*#__PURE__*/const E=/*#__PURE__*/i.forwardRef(((r,a)=>{const{disableOutsidePointerEvents:m=!1,onEscapeKeyDown:E,onPointerDownOutside:C,onFocusOutside:b,onInteractOutside:w,onDismiss:L,...y}=r,D=c(),P=d()+1,T=P===D,g=f(m),x=v()+(m?1:0),O=x<g;n({disabled:m}),e((e=>{T&&(null==E||E(e),e.defaultPrevented||null==L||L())}));const{onPointerDownCapture:R}=function(e){const n=t(e),r=i.useRef(!1);return i.useEffect((()=>{const e=e=>{const t=e.target;if(t&&!r.current){const r=new CustomEvent("dismissableLayer.pointerDownOutside",{bubbles:!1,cancelable:!0,detail:{originalEvent:e}});t.addEventListener("dismissableLayer.pointerDownOutside",n,{once:!0}),t.dispatchEvent(r)}r.current=!1},t=window.setTimeout((()=>{document.addEventListener("pointerdown",e)}),0);return()=>{window.clearTimeout(t),document.removeEventListener("pointerdown",e)}}),[n]),{onPointerDownCapture:()=>r.current=!0}}((e=>{O||(null==C||C(e),null==w||w(e),e.defaultPrevented||null==L||L())})),{onBlurCapture:h,onFocusCapture:F}=function(e){const n=t(e),r=i.useRef(!1);return i.useEffect((()=>{const e=e=>{const t=e.target;if(t&&!r.current){const r=new CustomEvent("dismissableLayer.focusOutside",{bubbles:!1,cancelable:!0,detail:{originalEvent:e}});t.addEventListener("dismissableLayer.focusOutside",n,{once:!0}),t.dispatchEvent(r)}};return document.addEventListener("focusin",e),()=>document.removeEventListener("focusin",e)}),[n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}((e=>{null==b||b(e),null==w||w(e),e.defaultPrevented||null==L||L()})),k=g>0&&!O;/*#__PURE__*/return i.createElement(l,{runningCount:P},/*#__PURE__*/i.createElement(p,{runningCount:x},/*#__PURE__*/i.createElement(o.div,s({},y,{ref:a,style:{pointerEvents:k?"auto":void 0,...y.style},onPointerDownCapture:u(r.onPointerDownCapture,R),onBlurCapture:u(r.onBlurCapture,h),onFocusCapture:u(r.onFocusCapture,F)}))))}));function C(e){const[t,n]=r("TotalLayerCount",{total:0,onTotalIncrease:()=>{},onTotalDecrease:()=>{}}),o=({children:e})=>{const[n,r]=i.useState(0);/*#__PURE__*/return i.createElement(t,{total:n,onTotalIncrease:i.useCallback((()=>r((e=>e+1))),[]),onTotalDecrease:i.useCallback((()=>r((e=>e-1))),[])},e)};return[o,function(e=!0){const{total:t,onTotalIncrease:r,onTotalDecrease:o}=n("TotalLayerCountConsumer");return i.useLayoutEffect((()=>{if(e)return r(),()=>o()}),[e,r,o]),t}]}function b(e){const[t,n]=r("RunningLayerCount",{count:0}),o=e=>{const{children:n,runningCount:r}=e;/*#__PURE__*/return i.createElement(t,{count:r},n)};return[o,function(){return n("RunningLayerCountConsumer").count||0}]}export const Root=DismissableLayer;
//# sourceMappingURL=index.module.js.map
